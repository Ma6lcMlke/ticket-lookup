<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
  <title>Ticket Lookup (QR-URL → ticket_id)</title>
  <style>
    :root { --radius: 14px; }
    html, body { margin:0; padding:0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji"; background:#0b1020; color:#eef2ff; }
    header { padding:16px; text-align:center; background:linear-gradient(180deg, #131a35, #0b1020); position:sticky; top:0; z-index:2; border-bottom:1px solid rgba(255,255,255,.06); }
    h1 { font-size:18px; margin:0; }
    main { padding:16px; max-width:1000px; margin:0 auto; }
    .card { background:#111834; border:1px solid rgba(255,255,255,.08); border-radius:var(--radius); padding:16px; box-shadow:0 8px 24px rgba(0,0,0,.25); }
    .grid { display:grid; gap:16px; }
    @media(min-width:980px) { .grid { grid-template-columns: 1.1fr .9fr; } }
    video, canvas { width:100%; border-radius:12px; background:#020617; }
    .lookup { display:flex; gap:8px; }
    .lookup input { flex:1; padding:12px 14px; border-radius:12px; border:1px solid rgba(255,255,255,.12); background:#0b122b; color:#e5e7eb; outline:none; }
    .lookup button { padding:12px 14px; border-radius:12px; border:0; background:#3b82f6; color:white; font-weight:600; }
    .result { padding:12px 14px; border-radius:12px; background:#0b122b; border:1px solid rgba(255,255,255,.08); font-size:14px; }
    .pill { display:inline-block; padding:6px 10px; border-radius:999px; background:#0f172a; border:1px solid rgba(255,255,255,.1); font-size:12px; color:#cbd5e1 }
    .muted { color:#9aa4bf; }
    .success { color:#34d399; }
    .danger { color:#f87171; }
    footer { text-align:center; padding:24px; color:#94a3b8; }
    .small { font-size:12px; }
    .row { display:flex; gap:8px; align-items:center; flex-wrap:wrap; }
    .btn-secondary { padding:10px 12px; border-radius:10px; border:1px solid rgba(255,255,255,.15); background:#0b122b; color:#e5e7eb; }
    .dropzone { margin-top:8px; padding:16px; border:2px dashed rgba(255,255,255,.2); border-radius:12px; text-align:center; background:#0b122b; }
    select { background:#0b122b; color:#e5e7eb; border:1px solid rgba(255,255,255,.15); border-radius:10px; padding:8px; }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/jsqr@1.4.0/dist/jsQR.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
</head>
<body>
  <header>
    <h1>Ticket Lookup & QR Scanner</h1>
    <div class="small muted">
      Datensätze geladen: <span id="count">948</span> ·
      Quelle: <span id="sourceLabel">Eingebettet</span> ·
      Zuletzt aktualisiert: <span id="updatedLabel">–</span>
    </div>
  </header>

  <main class="grid">
    <section class="card">
      <h2>QR-Code scannen</h2>
      <p class="muted small">Erlaube der Seite die Kamera zu nutzen. Halte den QR-Code ins Bild.</p>
      <video id="video" playsinline></video>
      <canvas id="canvas" style="display:none;"></canvas>
      <div id="scanStatus" class="small muted" style="margin-top:8px;">Scanner bereit…</div>
      <div id="scanResult" class="result" style="margin-top:8px;">Noch kein Code erfasst.</div>
    </section>

    <section class="card">
      <h2>Manuelle Eingabe & Datensatz laden</h2>
      <div class="lookup">
        <input id="ticketInput" type="text" placeholder="Ticket-ID oder komplette QR-URL einfügen">
        <button id="lookupBtn">Prüfen</button>
      </div>
      <div id="lookupResult" class="result" style="margin-top:8px;">Gib eine Ticket-ID oder die komplette QR-URL ein.</div>

      <div class="row" style="margin-top:12px;">
        <button id="loadCsvBtn" class="btn-secondary">CSV laden/aktualisieren</button>
        <input id="csvFile" type="file" accept=".csv,.txt" style="display:none;">
        <button id="clearLocalBtn" class="btn-secondary">Lokales Mapping löschen</button>
      </div>
      <div id="dropzone" class="dropzone small muted">CSV hierher ziehen & ablegen oder Button oben nutzen.</div>

      <div style="margin-top:12px;" class="small">
        <div class="pill">Vermutete Ticket-Spalte: <strong id="ticketColPill">Ticket-ID</strong></div>
        <div class="pill">Vermutete Item-Spalte: <strong id="itemColPill">Item Name</strong></div>
      </div>

      <div id="colPicker" style="display:none; margin-top:12px;" class="small">
        <div><strong>Spalten manuell wählen (optional):</strong></div>
        <div class="row" style="margin-top:6px;">
          <label>Ticket-ID:&nbsp;<select id="ticketSelect"></select></label>
          <label>Item-Name:&nbsp;<select id="itemSelect"></select></label>
          <button id="applyColsBtn" class="btn-secondary">Spalten anwenden</button>
        </div>
      </div>
    </section>
  </main>

  <footer class="small">© 2025 – URL-fähiger Ticket Lookup</footer>

  <script>
  let TICKET_TO_ITEM = {"38129.0": "Eintritts-Ticket 19.-20.9.2025", "38126.0": "Eintritts-Ticket 19.-20.9.2025", "38124.0": "Kleinaussteller-Park-Ticket 19.-20.9.2025", "38121.0": "Eintritts-Ticket 19.-20.9.2025", "38119.0": "Eintritts-Ticket 19.-20.9.2025", "38115.0": "Abschluss-Barbeque 20.9.2025", "38094.0": "Abschluss-Barbeque 20.9.2025", "38073.0": "Abschluss-Barbeque 20.9.2025", "38070.0": "Abschluss-Barbeque 20.9.2025", "38057.0": "Abschluss-Barbeque 20.9.2025", "38054.0": "Eintritts-Ticket 19.-20.9.2025", "38048.0": "Auftakt-Barbeque 19.9.2025", "38040.0": "Abschluss-Barbeque 20.9.2025", "38037.0": "Eintritts-Ticket 19.-20.9.2025", "38035.0": "Eintritts-Ticket 19.-20.9.2025", "38033.0": "Eintritts-Ticket 19.-20.9.2025", "38031.0": "Enthusiasten-Park-Ticket 19.-20.9.2025", "38028.0": "Enthusiasten-Park-Ticket 19.-20.9.2025", "38026.0": "Eintritts-Ticket 19.-20.9.2025", "38023.0": "Eintritts-Ticket 19.-20.9.2025", "38018.0": "Kinder-Ticket 19.-20.9.2025", "38015.0": "Tesla-Lightshow-Park-Ticket 19.-20.9.2025", "38002.0": "Abschluss-Barbeque 20.9.2025", "37999.0": "Kinder-Ticket 19.-20.9.2025", "37995.0": "Abschluss-Barbeque 20.9.2025", "37992.0": "Eintritts-Ticket 19.-20.9.2025", "37984.0": "Abschluss-Barbeque 20.9.2025", "37980.0": "Tesla-Lightshow-Park-Ticket 19.-20.9.2025", "37976.0": "Abschluss-Barbeque 20.9.2025", "37973.0": "Eintritts-Ticket 19.-20.9.2025", "37954.0": "Abschluss-Barbeque 20.9.2025", "37951.0": "Abschluss-Barbeque 20.9.2025", "37934.0": "Abschluss-Barbeque 20.9.2025", "37932.0": "Enthusiasten-Park-Ticket 19.-20.9.2025", "37930.0": "Kleinaussteller-Park-Ticket 19.-20.9.2025", "37928.0": "E-Camping - 1 Person - 1 Fahrzeug 19.-21.9.2025", "37926.0": "Eintritts-Ticket 19.-20.9.2025", "37907.0": "Auftakt-Barbeque 19.9.2025", "37903.0": "Tesla-Lightshow-Park-Ticket 19.-20.9.2025", "37901.0": "Tesla-Lightshow-Park-Ticket 19.-20.9.2025", "37896.0": "Abschluss-Barbeque 20.9.2025", "37894.0": "Eintritts-Ticket 19.-20.9.2025", "37887.0": "Abschluss-Barbeque 20.9.2025", "37885.0": "Eintritts-Ticket 19.-20.9.2025", "37880.0": "Abschluss-Barbeque 20.9.2025", "37876.0": "Eintritts-Ticket 19.-20.9.2025", "37865.0": "Abschluss-Barbeque 20.9.2025", "37863.0": "Auftakt-Barbeque 19.9.2025", "37858.0": "Eintritts-Ticket 19.-20.9.2025", "37852.0": "Enthusiasten-Park-Ticket 19.-20.9.2025", "37850.0": "Eintritts-Ticket 19.-20.9.2025", "37848.0": "Tesla-Lightshow-Park-Ticket 19.-20.9.2025", "37846.0": "Eintritts-Ticket 19.-20.9.2025", "37841.0": "Abschluss-Barbeque 20.9.2025", "37838.0": "Eintritts-Ticket 19.-20.9.2025", "37836.0": "Eintritts-Ticket 19.-20.9.2025", "37833.0": "Eintritts-Ticket 19.-20.9.2025", "37830.0": "Abschluss-Barbeque 20.9.2025", "37829.0": "T&amp", "37827.0": "T&amp", "37820.0": "Enthusiasten-Park-Ticket 19.-20.9.2025", "37817.0": "Eintritts-Ticket 19.-20.9.2025", "37815.0": "Eintritts-Ticket 19.-20.9.2025", "37812.0": "Eintritts-Ticket 19.-20.9.2025", "37809.0": "Abschluss-Barbeque 20.9.2025", "37805.0": "Abschluss-Barbeque 20.9.2025", "37801.0": "Enthusiasten-Park-Ticket 19.-20.9.2025", "37796.0": "Abschluss-Barbeque 20.9.2025", "37792.0": "Enthusiasten-Park-Ticket 19.-20.9.2025", "37791.0": "T&Emagazin Abon­ne­ment - 1er", "37789.0": "Tesla-Lightshow-Park-Ticket 19.-20.9.2025", "37785.0": "Eintritts-Ticket 19.-20.9.2025", "37781.0": "Kinder-Ticket 19.-20.9.2025", "37779.0": "Tesla-Lightshow-Park-Ticket 19.-20.9.2025", "37777.0": "E-Camping - 1 Person - 1 Fahrzeug 19.-21.9.2025", "37776.0": "T&Emagazin Abon­ne­ment - 1er", "37742.0": "Enthusiasten-Park-Ticket 19.-20.9.2025", "37740.0": "Eintritts-Ticket 19.-20.9.2025", "37738.0": "Enthusiasten-Park-Ticket 19.-20.9.2025", "37733.0": "Abschluss-Barbeque 20.9.2025", "37729.0": "Jugend-Ticket 19.-20.9.2025", "37726.0": "Eintritts-Ticket 19.-20.9.2025", "37724.0": "Eintritts-Ticket 19.-20.9.2025", "37720.0": "Tesla-Lightshow-Park-Ticket 19.-20.9.2025", "37718.0": "Eintritts-Ticket 19.-20.9.2025", "37713.0": "Abschluss-Barbeque 20.9.2025", "37710.0": "Eintritts-Ticket 19.-20.9.2025", "37701.0": "Abschluss-Barbeque 20.9.2025", "37700.0": "Abokostenanpassung - Basis 5  / Jahr", "37699.0": "T&amp", "37696.0": "Eintritts-Ticket 19.-20.9.2025", "37693.0": "Enthusiasten-Park-Ticket 19.-20.9.2025", "37687.0": "Abschluss-Barbeque 20.9.2025", "37683.0": "Abschluss-Barbeque 20.9.2025", "37677.0": "Eintritts-Ticket 19.-20.9.2025", "37666.0": "Abschluss-Barbeque 20.9.2025", "37663.0": "Kinder-Ticket 19.-20.9.2025", "37661.0": "Enthusiasten-Park-Ticket 19.-20.9.2025", "37654.0": "Jugend-Ticket 19.-20.9.2025", "37652.0": "Enthusiasten-Park-Ticket 19.-20.9.2025", "37647.0": "Eintritts-Ticket 19.-20.9.2025", "37644.0": "Tesla-Lightshow-Park-Ticket 19.-20.9.2025", "37642.0": "Tesla-Lightshow-Park-Ticket 19.-20.9.2025", "37638.0": "Eintritts-Ticket 19.-20.9.2025", "37637.0": "T&Emagazin Abon­ne­ment", "37635.0": "Enthusiasten-Park-Ticket 19.-20.9.2025", "37633.0": "Eintritts-Ticket 19.-20.9.2025", "37631.0": "Enthusiasten-Park-Ticket 19.-20.9.2025", "37629.0": "Enthusiasten-Park-Ticket 19.-20.9.2025", "37626.0": "Enthusiasten-Park-Ticket 19.-20.9.2025", "37624.0": "Enthusiasten-Park-Ticket 19.-20.9.2025", "37622.0": "Enthusiasten-Park-Ticket 19.-20.9.2025", "37619.0": "Enthusiasten-Park-Ticket 19.-20.9.2025", "37617.0": "Enthusiasten-Park-Ticket 19.-20.9.2025", "37615.0": "Enthusiasten-Park-Ticket 19.-20.9.2025", "37613.0": "Enthusiasten-Park-Ticket 19.-20.9.2025", "37611.0": "Eintritts-Ticket 19.-20.9.2025", "37609.0": "Enthusiasten-Park-Ticket 19.-20.9.2025", "37607.0": "Enthusiasten-Park-Ticket 19.-20.9.2025", "37605.0": "Tesla-Lightshow-Park-Ticket 19.-20.9.2025", "37603.0": "Enthusiasten-Park-Ticket 19.-20.9.2025", "37600.0": "Abschluss-Barbeque 20.9.2025", "37597.0": "Mit E-Campen - 1 Person 19.-21.9.2025", "37595.0": "T&amp", "37592.0": "Eintritts-Ticket 19.-20.9.2025", "37589.0": "Eintritts-Ticket 19.-20.9.2025", "37587.0": "Eintritts-Ticket 19.-20.9.2025", "37584.0": "Abschluss-Barbeque 20.9.2025", "37581.0": "Eintritts-Ticket 19.-20.9.2025", "37580.0": "T&amp", "37576.0": "Eintritts-Ticket 19.-20.9.2025", "37574.0": "Eintritts-Ticket 19.-20.9.2025", "37570.0": "Jugend-Ticket 19.-20.9.2025", "37568.0": "Enthusiasten-Park-Ticket 19.-20.9.2025", "37564.0": "E-Camping - 1 Person - 1 Fahrzeug 19.-21.9.2025", "37555.0": "Abschluss-Barbeque (Kids) 20.9.2025", "37549.0": "Abschluss-Barbeque 20.9.2025", "37545.0": "Abschluss-Barbeque 20.9.2025", "37543.0": "T&amp", "37541.0": "E-Camping - 1 Person - 1 Fahrzeug 19.-21.9.2025", "37538.0": "Enthusiasten-Park-Ticket 19.-20.9.2025", "37533.0": "Abschluss-Barbeque 20.9.2025", "37529.0": "Abschluss-Barbeque 20.9.2025", "37519.0": "Abschluss-Barbeque 20.9.2025", "37516.0": "T&Emagazin Abon­ne­ment", "37515.0": "T&amp", "37512.0": "Eintritts-Ticket 19.-20.9.2025", "37509.0": "Eintritts-Ticket 19.-20.9.2025", "37502.0": "T&amp", "37499.0": "Eintritts-Ticket 19.-20.9.2025", "37489.0": "Abschluss-Barbeque (Kids) 20.9.2025", "37488.0": "T&amp", "37483.0": "Abschluss-Barbeque 20.9.2025", "37481.0": "Eintritts-Ticket 19.-20.9.2025", "37478.0": "Eintritts-Ticket 19.-20.9.2025", "37475.0": "Eintritts-Ticket 19.-20.9.2025", "37473.0": "Eintritts-Ticket 19.-20.9.2025", "37470.0": "E-Camping - 1 Person - 1 Fahrzeug 19.-21.9.2025", "37467.0": "Eintritts-Ticket 19.-20.9.2025", "37462.0": "Abschluss-Barbeque 20.9.2025", "37459.0": "Eintritts-Ticket 19.-20.9.2025", "37450.0": "Abschluss-Barbeque 20.9.2025", "37441.0": "Enthusiasten-Park-Ticket 19.-20.9.2025", "37439.0": "Eintritts-Ticket 19.-20.9.2025", "37437.0": "Kinder-Ticket 19.-20.9.2025", "37435.0": "Eintritts-Ticket 19.-20.9.2025", "37430.0": "Mit E-Campen - 1 Person 19.-21.9.2025", "37424.0": "Kinder-Ticket 19.-20.9.2025", "37417.0": "Auftakt-Barbeque 19.9.2025", "37415.0": "Enthusiasten-Park-Ticket 19.-20.9.2025", "37407.0": "Abschluss-Barbeque 20.9.2025", "37405.0": "Eintritts-Ticket 19.-20.9.2025", "37401.0": "Eintritts-Ticket 19.-20.9.2025", "37399.0": "Enthusiasten-Park-Ticket 19.-20.9.2025", "37395.0": "Eintritts-Ticket 19.-20.9.2025", "37392.0": "Enthusiasten-Park-Ticket 19.-20.9.2025", "37387.0": "Eintritts-Ticket 19.-20.9.2025", "37384.0": "Eintritts-Ticket 19.-20.9.2025", "37381.0": "Eintritts-Ticket 19.-20.9.2025", "37379.0": "Eintritts-Ticket 19.-20.9.2025", "37378.0": "T&Emagazin Abon­ne­ment - 1er", "37377.0": "T&Emagazin Abon­ne­ment 5x Ausgaben", "37372.0": "Tesla-Lightshow-Park-Ticket 19.-20.9.2025", "37367.0": "Abschluss-Barbeque 20.9.2025", "37365.0": "Mit E-Campen - 1 Person 19.-21.9.2025", "37360.0": "Abschluss-Barbeque 20.9.2025", "37359.0": "T&Emagazin Abon­ne­ment", "37358.0": "T&Emagazin Abon­ne­ment 5x Ausgaben", "37357.0": "T&Emagazin Abon­ne­ment", "37356.0": "T&Emagazin Abon­ne­ment 5x Ausgaben", "37355.0": "T&Emagazin Abon­ne­ment", "37354.0": "T&Emagazin Abon­ne­ment", "37352.0": "Kinder-Ticket 19.-20.9.2025", "37349.0": "Tesla-Lightshow-Park-Ticket 19.-20.9.2025", "37347.0": "T&amp", "37346.0": "T&amp", "37338.0": "Abschluss-Barbeque 20.9.2025", "37334.0": "Tesla-Lightshow-Park-Ticket 19.-20.9.2025", "37329.0": "E-Camping - 1 Person - 1 Fahrzeug 19.-21.9.2025", "37325.0": "Tesla-Lightshow-Park-Ticket 19.-20.9.2025", "37322.0": "Abschluss-Barbeque 20.9.2025", "37316.0": "Abschluss-Barbeque 20.9.2025", "37314.0": "Eintritts-Ticket 19.-20.9.2025", "37303.0": "Abschluss-Barbeque 20.9.2025", "37299.0": "Abschluss-Barbeque 20.9.2025", "37293.0": "Abschluss-Barbeque 20.9.2025", "37291.0": "Enthusiasten-Park-Ticket 19.-20.9.2025", "37277.0": "Abschluss-Barbeque 20.9.2025", "37276.0": "T&amp", "37271.0": "Auftakt-Barbeque 19.9.2025", "37268.0": "Auftakt-Barbeque 19.9.2025", "37264.0": "Tesla-Lightshow-Park-Ticket 19.-20.9.2025", "37263.0": "T&amp", "37260.0": "Eintritts-Ticket 19.-20.9.2025", "37258.0": "Eintritts-Ticket 19.-20.9.2025", "37256.0": "Eintritts-Ticket 19.-20.9.2025", "37247.0": "Abschluss-Barbeque 20.9.2025", "37245.0": "Eintritts-Ticket 19.-20.9.2025", "37244.0": "T&amp", "37240.0": "Enthusiasten-Park-Ticket 19.-20.9.2025", "37236.0": "Tesla-Lightshow-Park-Ticket 19.-20.9.2025", "37235.0": "T&amp", "37233.0": "Eintritts-Ticket 19.-20.9.2025", "37227.0": "Abschluss-Barbeque 20.9.2025", "37224.0": "Eintritts-Ticket 19.-20.9.2025", "37221.0": "Eintritts-Ticket 19.-20.9.2025", "37218.0": "Auftakt-Barbeque 19.9.2025", "37217.0": "T&Emagazin Abon­ne­ment 5x Ausgaben", "37215.0": "E-Camping - 1 Person - 1 Fahrzeug 19.-21.9.2025", "37213.0": "Eintritts-Ticket 19.-20.9.2025", "37203.0": "Abschluss-Barbeque 20.9.2025", "37199.0": "Tesla-Lightshow-Park-Ticket 19.-20.9.2025", "37194.0": "Abschluss-Barbeque 20.9.2025", "37190.0": "Abschluss-Barbeque 20.9.2025", "37186.0": "Eintritts-Ticket 19.-20.9.2025", "37184.0": "E-Camping - 1 Person - 1 Fahrzeug 19.-21.9.2025", "37179.0": "Abschluss-Barbeque (Kids) 20.9.2025", "37176.0": "Eintritts-Ticket 19.-20.9.2025", "37169.0": "Auftakt-Barbeque 19.9.2025", "37166.0": "Mit E-Campen - 1 Person 19.-21.9.2025", "37160.0": "T&amp", "37155.0": "Tesla-Lightshow-Park-Ticket 19.-20.9.2025", "37151.0": "Auftakt-Barbeque 19.9.2025", "37144.0": "Enthusiasten-Park-Ticket 19.-20.9.2025", "37142.0": "Eintritts-Ticket 19.-20.9.2025", "37137.0": "Tesla-Lightshow-Park-Ticket 19.-20.9.2025", "37131.0": "Tesla-Lightshow-Park-Ticket 19.-20.9.2025", "37126.0": "Abschluss-Barbeque 20.9.2025", "37117.0": "Eintritts-Ticket 19.-20.9.2025", "37113.0": "Eintritts-Ticket 19.-20.9.2025", "37110.0": "T&Emagazin Abon­ne­ment 5x Ausgaben", "37101.0": "Auftakt-Barbeque 19.9.2025", "37099.0": "Eintritts-Ticket 19.-20.9.2025", "37095.0": "Abschluss-Barbeque 20.9.2025", "37092.0": "Jugend-Ticket 19.-20.9.2025", "37089.0": "Eintritts-Ticket 19.-20.9.2025", "37088.0": "Abokostenanpassung - Basis 5  / Jahr", "37086.0": "Eintritts-Ticket 19.-20.9.2025", "37083.0": "Abschluss-Barbeque 20.9.2025", "37072.0": "Abschluss-Barbeque 20.9.2025", "37065.0": "Abschluss-Barbeque 20.9.2025", "37064.0": "T&amp", "37058.0": "Abschluss-Barbeque 20.9.2025", "37052.0": "Abschluss-Barbeque 20.9.2025", "37049.0": "Eintritts-Ticket 19.-20.9.2025", "37038.0": "Abschluss-Barbeque 20.9.2025", "37030.0": "Abschluss-Barbeque 20.9.2025", "37027.0": "Eintritts-Ticket 19.-20.9.2025", "37024.0": "Tesla-Lightshow-Park-Ticket 19.-20.9.2025", "37018.0": "Eintritts-Ticket 19.-20.9.2025", "37008.0": "Abschluss-Barbeque 20.9.2025", "37001.0": "Tesla-Lightshow-Park-Ticket 19.-20.9.2025", "36996.0": "Abschluss-Barbeque 20.9.2025", "36989.0": "Auftakt-Barbeque 19.9.2025", "36987.0": "Auftakt-Barbeque 19.9.2025", "36982.0": "Auftakt-Barbeque (Kids) 19.9.2025", "36976.0": "Abschluss-Barbeque 20.9.2025", "36973.0": "Mit E-Campen - 1 Person 19.-21.9.2025", "36969.0": "T&Emagazin Abon­ne­ment - 1er", "36956.0": "Abschluss-Barbeque 20.9.2025", "36953.0": "Eintritts-Ticket 19.-20.9.2025", "36938.0": "Abschluss-Barbeque 20.9.2025", "36935.0": "Eintritts-Ticket 19.-20.9.2025", "36930.0": "T&amp", "36925.0": "Enthusiasten-Park-Ticket 19.-20.9.2025", "36920.0": "Enthusiasten-Park-Ticket 19.-20.9.2025", "36919.0": "T&Emagazin Abon­ne­ment", "36914.0": "Tesla-Lightshow-Park-Ticket 19.-20.9.2025", "36911.0": "Eintritts-Ticket 19.-20.9.2025", "36906.0": "Eintritts-Ticket 19.-20.9.2025", "36899.0": "Mit E-Campen - 1 Person 19.-21.9.2025", "36897.0": "T&amp", "36892.0": "Mit E-Campen - 1 Person 19.-21.9.2025", "36884.0": "Abschluss-Barbeque 20.9.2025", "36881.0": "Enthusiasten-Park-Ticket 19.-20.9.2025", "36877.0": "Kinder-Ticket 19.-20.9.2025", "36874.0": "Eintritts-Ticket 19.-20.9.2025", "36868.0": "Abschluss-Barbeque 20.9.2025", "36867.0": "T&amp", "36863.0": "Tesla-Lightshow-Park-Ticket 19.-20.9.2025", "36861.0": "T&amp", "36857.0": "Auftakt-Barbeque (Kids) 19.9.2025", "36856.0": "T&amp", "36855.0": "T&amp", "36852.0": "Eintritts-Ticket 19.-20.9.2025", "36851.0": "T&Emagazin Abon­ne­ment", "36849.0": "T&amp", "36848.0": "T&Emagazin Abon­ne­ment - 1er", "36847.0": "T&amp", "36843.0": "Eintritts-Ticket 19.-20.9.2025", "36841.0": "Auftakt-Barbeque 19.9.2025", "36840.0": "T&amp", "36839.0": "Bierdeckel - Energiewende auf einem Bierdeckel (5 Exemplare)", "36838.0": "T&amp", "36834.0": "Auftakt-Barbeque 19.9.2025", "36830.0": "Abschluss-Barbeque 20.9.2025", "36828.0": "Tesla-Lightshow-Park-Ticket 19.-20.9.2025", "36824.0": "Abschluss-Barbeque 20.9.2025", "36822.0": "Eintritts-Ticket 19.-20.9.2025", "36821.0": "T&amp", "36818.0": "Enthusiasten-Park-Ticket 19.-20.9.2025", "36812.0": "Abschluss-Barbeque 20.9.2025", "36811.0": "T&Emagazin Abon­ne­ment - 5er", "36809.0": "Eintritts-Ticket 19.-20.9.2025", "36807.0": "Eintritts-Ticket 19.-20.9.2025", "36806.0": "T&amp", "36805.0": "T&amp", "36804.0": "T&amp", "36803.0": "T&amp", "36799.0": "Enthusiasten-Park-Ticket 19.-20.9.2025", "36793.0": "Abschluss-Barbeque 20.9.2025", "36788.0": "Kleinaussteller-Park-Ticket 19.-20.9.2025", "36783.0": "Mit E-Campen - 1 Person 19.-21.9.2025", "36777.0": "Auftakt-Barbeque 19.9.2025", "36771.0": "Abschluss-Barbeque 20.9.2025", "36770.0": "T&amp", "36769.0": "T&amp", "36765.0": "Kinder-Ticket 19.-20.9.2025", "36762.0": "Eintritts-Ticket 19.-20.9.2025", "36757.0": "Eintritts-Ticket 19.-20.9.2025", "36756.0": "T&amp", "36755.0": "T&amp", "36754.0": "T&amp", "36748.0": "T&Emagazin Abon­ne­ment - 1er", "36743.0": "Jugend-Ticket 19.-20.9.2025", "36731.0": "T&Emagazin Abon­ne­ment - 1er", "36728.0": "Eintritts-Ticket 19.-20.9.2025", "36723.0": "Tesla-Lightshow-Park-Ticket 19.-20.9.2025", "36721.0": "T&Emagazin Abon­ne­ment - 1er", "36716.0": "Mit E-Campen - 1 Person 19.-21.9.2025", "36713.0": "Eintritts-Ticket 19.-20.9.2025", "36708.0": "Kinder-Ticket 19.-20.9.2025", "36705.0": "Eintritts-Ticket 19.-20.9.2025", "36704.0": "T&Emagazin Abon­ne­ment", "36703.0": "T&Emagazin Abon­ne­ment - 1er", "36702.0": "T&Emagazin Abon­ne­ment", "36701.0": "TFF-Aufkleber - rot (TFF Forum)", "36695.0": "Tesla-Lightshow-Park-Ticket 19.-20.9.2025", "36692.0": "Eintritts-Ticket 19.-20.9.2025", "36687.0": "Tesla-Lightshow-Park-Ticket 19.-20.9.2025", "36686.0": "Die T&amp", "36681.0": "Enthusiasten-Park-Ticket 19.-20.9.2025", "36677.0": "T&amp", "36676.0": "T&Emagazin Abon­ne­ment", "36675.0": "Abokostenanpassung - Kür 25 / Jahr", "36672.0": "Eintritts-Ticket 19.-20.9.2025", "36666.0": "Abschluss-Barbeque 20.9.2025", "36664.0": "T&amp", "36659.0": "Abschluss-Barbeque 20.9.2025", "36657.0": "Eintritts-Ticket 19.-20.9.2025", "36656.0": "T&Emagazin Abon­ne­ment", "36655.0": "T&Emagazin Abon­ne­ment - 1er", "36654.0": "T&Emagazin Abon­ne­ment", "36651.0": "Kleinaussteller-Park-Ticket 19.-20.9.2025", "36650.0": "Abokostenanpassung - Premium 10  / Jahr", "36649.0": "T&Emagazin Abon­ne­ment - 1er", "36646.0": "Eintritts-Ticket 19.-20.9.2025", "36642.0": "Eintritts-Ticket 19.-20.9.2025", "36641.0": "T&Emagazin Abon­ne­ment - 1er", "36638.0": "E-Camping - 1 Person - 1 Fahrzeug 19.-21.9.2025", "36637.0": "T&Emagazin Abon­ne­ment - 1er", "36630.0": "Tesla-Lightshow-Park-Ticket 19.-20.9.2025", "36624.0": "Enthusiasten-Park-Ticket 19.-20.9.2025", "36623.0": "T&Emagazin Abon­ne­ment 5x Ausgaben", "36619.0": "Tesla-Lightshow-Park-Ticket 19.-20.9.2025", "36614.0": "Enthusiasten-Park-Ticket 19.-20.9.2025", "36613.0": "Abokostenanpassung - Premium 10  / Jahr", "36606.0": "Auftakt-Barbeque (Kids) 19.9.2025", "36604.0": "Eintritts-Ticket 19.-20.9.2025", "36601.0": "Enthusiasten-Park-Ticket 19.-20.9.2025", "36599.0": "Eintritts-Ticket 19.-20.9.2025", "36597.0": "Enthusiasten-Park-Ticket 19.-20.9.2025", "36590.0": "Abschluss-Barbeque 20.9.2025", "36588.0": "Eintritts-Ticket 19.-20.9.2025", "36585.0": "Eintritts-Ticket 19.-20.9.2025", "36577.0": "Abschluss-Barbeque 20.9.2025", "36573.0": "Enthusiasten-Park-Ticket 19.-20.9.2025", "36571.0": "E-Camping - 1 Person - 1 Fahrzeug 19.-21.9.2025", "36568.0": "Tesla-Lightshow-Park-Ticket 19.-20.9.2025", "36565.0": "Eintritts-Ticket 19.-20.9.2025", "36561.0": "Kinder-Ticket 19.-20.9.2025", "36560.0": "T&Emagazin Abon­ne­ment", "36559.0": "T&amp", "36558.0": "T&amp", "36551.0": "Auftakt-Barbeque 19.9.2025", "36550.0": "T&amp", "36547.0": "Eintritts-Ticket 19.-20.9.2025", "36546.0": "T&Emagazin Abon­ne­ment - 1er", "36541.0": "T&amp", "36534.0": "Tesla-Lightshow-Park-Ticket 19.-20.9.2025", "36533.0": "T&Emagazin Abon­ne­ment x 5 Ausgaben (inkl. Versandpauschale)", "36532.0": "T&Emagazin Abon­ne­ment", "36526.0": "Eintritts-Ticket 19.-20.9.2025", "36523.0": "Eintritts-Ticket 19.-20.9.2025", "36519.0": "Kleinaussteller-Park-Ticket 19.-20.9.2025", "36518.0": "Abokostenanpassung - Basis 5  / Jahr", "36517.0": "T&amp", "36516.0": "T&amp", "36515.0": "T&amp", "36514.0": "T&amp", "36513.0": "Abokostenanpassung - Kür 25 / Jahr", "36512.0": "T&Emagazin Abon­ne­ment 5x Ausgaben", "36511.0": "T&Emagazin Abon­ne­ment - 1er", "36505.0": "T&Emagazin Abon­ne­ment 5x Ausgaben", "36496.0": "Enthusiasten-Park-Ticket 19.-20.9.2025", "36485.0": "Abschluss-Barbeque 20.9.2025", "36481.0": "Kinder-Ticket 19.-20.9.2025", "36480.0": "T&amp", "36477.0": "T&Emagazin Abon­ne­ment", "36476.0": "T&Emagazin Abon­ne­ment", "36475.0": "T&Emagazin Abon­ne­ment", "36474.0": "T&Emagazin Abon­ne­ment", "36473.0": "T&Emagazin Abon­ne­ment", "36472.0": "T&Emagazin Abon­ne­ment", "36471.0": "T&amp", "36470.0": "Abokostenanpassung - Premium 10  / Jahr", "36469.0": "Abokostenanpassung - Premium 10  / Jahr", "36464.0": "Eintritts-Ticket 19.-20.9.2025", "36463.0": "T&amp", "36462.0": "T&Emagazin Abon­ne­ment - 1er", "36457.0": "Mit E-Campen - 1 Person 19.-21.9.2025", "36456.0": "T&amp", "36455.0": "T&amp", "36454.0": "T&amp", "36452.0": "E-Camping - 1 Person - 1 Fahrzeug 19.-21.9.2025", "36449.0": "Eintritts-Ticket 19.-20.9.2025", "36448.0": "Die T&amp", "36445.0": "Auftakt-Barbeque 19.9.2025", "36444.0": "T&amp", "36441.0": "Enthusiasten-Park-Ticket 19.-20.9.2025", "36435.0": "Abschluss-Barbeque 20.9.2025", "36432.0": "Eintritts-Ticket 19.-20.9.2025", "36422.0": "Abschluss-Barbeque 20.9.2025", "36421.0": "T&amp", "36420.0": "T&Emagazin Abon­ne­ment", "36419.0": "T&Emagazin Abon­ne­ment - 1er", "36415.0": "Abschluss-Barbeque 20.9.2025", "36411.0": "Kinder-Ticket 19.-20.9.2025", "36406.0": "Eintritts-Ticket 19.-20.9.2025", "36400.0": "Enthusiasten-Park-Ticket 19.-20.9.2025", "36398.0": "Abokostenanpassung - Basis 5  / Jahr", "36392.0": "Tesla-Lightshow-Park-Ticket 19.-20.9.2025", "36389.0": "Enthusiasten-Park-Ticket 19.-20.9.2025", "36382.0": "Abschluss-Barbeque 20.9.2025", "36381.0": "T&amp", "36376.0": "Eintritts-Ticket 19.-20.9.2025", "36375.0": "T&Emagazin Abon­ne­ment 5x Ausgaben", "36367.0": "T&amp", "36366.0": "T&Emagazin Abon­ne­ment - 1er", "36362.0": "Mit E-Campen - 1 Person 19.-21.9.2025", "36361.0": "T&Emagazin Abon­ne­ment - 1er", "36357.0": "Abschluss-Barbeque 20.9.2025", "36356.0": "T&Emagazin Abon­ne­ment", "36351.0": "Jugend-Ticket 19.-20.9.2025", "36348.0": "Auftakt-Barbeque 19.9.2025", "36347.0": "T&amp", "36346.0": "T&amp", "36343.0": "Eintritts-Ticket 19.-20.9.2025", "36342.0": "T&amp", "36338.0": "Abschluss-Barbeque 20.9.2025", "36337.0": "Abokostenanpassung - Basis 5  / Jahr", "36335.0": "T&amp", "36334.0": "T&amp", "36328.0": "Abschluss-Barbeque 20.9.2025", "36327.0": "T&amp", "36326.0": "T&amp", "36324.0": "T&amp", "36322.0": "T&Emagazin Abon­ne­ment", "36321.0": "T&Emagazin Abon­ne­ment - 1er", "36320.0": "T&amp", "36315.0": "Kinder-Ticket 19.-20.9.2025", "36314.0": "T&amp", "36313.0": "T&amp", "36312.0": "T&amp", "36311.0": "T&Emagazin Abon­ne­ment - 1er", "36308.0": "Enthusiasten-Park-Ticket 19.-20.9.2025", "36305.0": "Eintritts-Ticket 19.-20.9.2025", "36302.0": "Eintritts-Ticket 19.-20.9.2025", "36300.0": "Eintritts-Ticket 19.-20.9.2025", "36295.0": "Abschluss-Barbeque 20.9.2025", "36291.0": "Jugend-Ticket 19.-20.9.2025", "36286.0": "Eintritts-Ticket 19.-20.9.2025", "36285.0": "T&amp", "36282.0": "T&Emagazin Abon­ne­ment x 5 Ausgaben (inkl. Versandpauschale)", "36281.0": "T&Emagazin Abon­ne­ment x 5 Ausgaben (inkl. Versandpauschale)", "36279.0": "T&Emagazin Abon­ne­ment x 5 Ausgaben (inkl. Versandpauschale)", "36278.0": "T&Emagazin Abon­ne­ment - 1er", "36275.0": "E-Camping - 1 Person - 1 Fahrzeug 19.-21.9.2025", "36274.0": "T&amp", "36273.0": "T&Emagazin Abon­ne­ment - 1er", "36269.0": "Enthusiasten-Park-Ticket 19.-20.9.2025", "36267.0": "E-Camping - 1 Person - 1 Fahrzeug 19.-21.9.2025", "36266.0": "T&Emagazin Abon­ne­ment x 5 Ausgaben (inkl. Versandpauschale)", "36264.0": "T&Emagazin Abon­ne­ment (inkl. Versandpauschale)", "36263.0": "Die T&amp", "36262.0": "T&Emagazin Abon­ne­ment (inkl. Versandpauschale)", "36261.0": "T&Emagazin Abon­ne­ment x 5 Ausgaben (inkl. Versandpauschale)", "36258.0": "Mit E-Campen - 1 Person 19.-21.9.2025", "36257.0": "T&Emagazin Abon­ne­ment - 1er", "36254.0": "E-Camping - 1 Person - 1 Fahrzeug 19.-21.9.2025", "36252.0": "Eintritts-Ticket 19.-20.9.2025", "36250.0": "Enthusiasten-Park-Ticket 19.-20.9.2025", "36240.0": "Auftakt-Barbeque 19.9.2025", "36238.0": "E-Camping - 1 Person - 1 Fahrzeug 19.-21.9.2025", "36236.0": "Tesla-Lightshow-Park-Ticket 19.-20.9.2025", "36229.0": "Eintritts-Ticket 19.-20.9.2025", "36227.0": "T&Emagazin Abon­ne­ment - 1er", "36226.0": "T&amp", "36225.0": "T&Emagazin Abon­ne­ment x 10 Ausgaben (inkl. Versandpauschale)", "36224.0": "T&Emagazin Abon­ne­ment x 5 Ausgaben (inkl. Versandpauschale)", "36220.0": "Jugend-Ticket 19.-20.9.2025", "36214.0": "Abschluss-Barbeque 20.9.2025", "36211.0": "Kleinaussteller-Park-Ticket 19.-20.9.2025", "36209.0": "Eintritts-Ticket 19.-20.9.2025", "36206.0": "T&amp", "36205.0": "T&Emagazin Abon­ne­ment - 1er", "36204.0": "T&amp", "36203.0": "T&amp", "36199.0": "Enthusiasten-Park-Ticket 19.-20.9.2025", "36198.0": "T&Emagazin Abon­ne­ment (inkl. Versandpauschale)", "36197.0": "T&Emagazin Abon­ne­ment (inkl. Versandpauschale)", "36196.0": "T&Emagazin Abon­ne­ment x 5 Ausgaben (inkl. Versandpauschale)", "36195.0": "T&amp", "36194.0": "T&amp", "36189.0": "Tesla-Lightshow-Park-Ticket 19.-20.9.2025", "36188.0": "Abokostenanpassung - Basis 5  / Jahr", "36187.0": "T&amp", "36186.0": "T&Emagazin Abon­ne­ment - 5er", "36184.0": "T&amp", "36182.0": "T&Emagazin Abon­ne­ment - 1er", "36181.0": "T&Emagazin Abon­ne­ment - 1er", "36180.0": "Abokostenanpassung - Basis 5  / Jahr", "36179.0": "T&Emagazin Abon­ne­ment - 1er", "36178.0": "T&Emagazin Abon­ne­ment - 1er", "36177.0": "T&Emagazin Abon­ne­ment - 1er", "36176.0": "T&Emagazin Abon­ne­ment - 5er", "36175.0": "T&amp", "36172.0": "E-Camping - 1 Person - 1 Fahrzeug 19.-21.9.2025", "36171.0": "T&Emagazin Abon­ne­ment - 1er", "36170.0": "T&amp", "36169.0": "T&amp", "36168.0": "T&amp", "36167.0": "Abokostenanpassung - Premium 10  / Jahr", "36166.0": "T&Emagazin Abon­ne­ment (inkl. Versandpauschale)", "36165.0": "T&Emagazin Abon­ne­ment - 1er", "36164.0": "T&amp", "36163.0": "T&Emagazin Abon­ne­ment (inkl. Versandpauschale)", "36162.0": "T&Emagazin Abon­ne­ment - 5er", "36160.0": "T&amp", "36159.0": "T&Emagazin Abon­ne­ment - 1er", "36158.0": "T&amp", "36157.0": "Abokostenanpassung - Kür 25 / Jahr", "36155.0": "T&amp", "36151.0": "Tesla-Lightshow-Park-Ticket 19.-20.9.2025", "36150.0": "T&amp", "36145.0": "Abschluss-Barbeque 20.9.2025", "36144.0": "T&amp", "36143.0": "T&amp", "36142.0": "T&Emagazin Abon­ne­ment (inkl. Versandpauschale)", "36139.0": "Enthusiasten-Park-Ticket 19.-20.9.2025", "36138.0": "T&amp", "36137.0": "T&Emagazin Abon­ne­ment (inkl. Versandpauschale)", "36132.0": "Abschluss-Barbeque 20.9.2025", "36131.0": "T&Emagazin Abon­ne­ment - 1er", "36130.0": "T&Emagazin Abon­ne­ment - 1er", "36129.0": "T&amp", "36128.0": "T&amp", "36126.0": "Eintritts-Ticket 19.-20.9.2025", "36125.0": "T&Emagazin Abon­ne­ment - 1er", "36124.0": "T&Emagazin Abon­ne­ment x 5 Ausgaben (inkl. Versandpauschale)", "36120.0": "E-Camping - 1 Person - 1 Fahrzeug 19.-21.9.2025", "36119.0": "T&Emagazin Abon­ne­ment - 1er", "36118.0": "T&Emagazin Abon­ne­ment - 1er", "36117.0": "T&Emagazin Abon­ne­ment - 1er", "36116.0": "Abokostenanpassung - Basis 5  / Jahr", "36115.0": "Abokostenanpassung - Premium 10  / Jahr", "36114.0": "T&Emagazin Abon­ne­ment (inkl. Versandpauschale)", "36113.0": "T&amp", "36112.0": "T&amp", "36111.0": "T&Emagazin Abon­ne­ment - 1er", "36110.0": "T&amp", "36108.0": "E-Camping - 1 Person - 1 Fahrzeug 19.-21.9.2025", "36107.0": "T&amp", "36105.0": "T&amp", "36104.0": "T&amp", "36103.0": "T&amp", "36102.0": "T&Emagazin Abon­ne­ment - 1er", "36101.0": "T&Emagazin Abon­ne­ment x 5 Ausgaben (inkl. Versandpauschale)", "36100.0": "T&Emagazin Abon­ne­ment x 5 Ausgaben (inkl. Versandpauschale)", "36094.0": "Abschluss-Barbeque 20.9.2025", "36093.0": "T&amp", "36092.0": "T&amp", "36090.0": "T&amp", "36089.0": "T&amp", "36088.0": "T&Emagazin Abon­ne­ment - 1er", "36087.0": "Die T&amp", "36086.0": "T&amp", "36085.0": "T&amp", "36084.0": "T&amp", "36083.0": "T&amp", "36082.0": "T&amp", "36081.0": "T&amp", "36076.0": "T&amp", "36075.0": "T&Emagazin Abon­ne­ment - 1er", "36074.0": "T&Emagazin Abon­ne­ment (inkl. Versandpauschale)", "36073.0": "T&Emagazin Abon­ne­ment - 1er", "36072.0": "T&Emagazin Abon­ne­ment - 1er", "36071.0": "T&Emagazin Abon­ne­ment x 5 Ausgaben (inkl. Versandpauschale)", "36070.0": "T&Emagazin Abon­ne­ment - 1er", "36069.0": "T&Emagazin Abon­ne­ment - 5er", "36068.0": "T&Emagazin Abon­ne­ment (inkl. Versandpauschale)", "36067.0": "Abokostenanpassung - Basis 5  / Jahr", "36066.0": "T&Emagazin Abon­ne­ment x 5 Ausgaben (inkl. Versandpauschale)", "36065.0": "T&Emagazin Abon­ne­ment - 5er", "36064.0": "T&Emagazin Abon­ne­ment (inkl. Versandpauschale)", "36063.0": "T&Emagazin Abon­ne­ment - 1er", "36062.0": "T&Emagazin Abon­ne­ment (inkl. Versandpauschale)", "36061.0": "T&Emagazin Abon­ne­ment x 5 Ausgaben (inkl. Versandpauschale)", "36060.0": "T&Emagazin Abon­ne­ment (inkl. Versandpauschale)", "36059.0": "T&Emagazin Abon­ne­ment - 1er", "36058.0": "T&Emagazin Abon­ne­ment x 10 Ausgaben (inkl. Versandpauschale)", "36057.0": "T&Emagazin Abon­ne­ment - 1er", "36056.0": "T&Emagazin Abon­ne­ment (inkl. Versandpauschale)", "36055.0": "T&Emagazin Abon­ne­ment (inkl. Versandpauschale)", "36054.0": "T&Emagazin Abon­ne­ment (inkl. Versandpauschale)", "36053.0": "T&Emagazin Abon­ne­ment (inkl. Versandpauschale)", "36052.0": "T&Emagazin Abon­ne­ment x 5 Ausgaben (inkl. Versandpauschale)", "36051.0": "T&Emagazin Abon­ne­ment - 5er", "36050.0": "T&Emagazin Abon­ne­ment x 5 Ausgaben (inkl. Versandpauschale)", "36049.0": "T&Emagazin Abon­ne­ment (inkl. Versandpauschale)", "36048.0": "T&Emagazin Abon­ne­ment - 1er", "36047.0": "T&Emagazin Abon­ne­ment (inkl. Versandpauschale)", "36037.0": "T&amp", "36035.0": "T&Emagazin Abon­ne­ment x 5 Ausgaben (inkl. Versandpauschale)", "36034.0": "T&Emagazin Abon­ne­ment - 5er", "36029.0": "Abschluss-Barbeque 20.9.2025", "36028.0": "T&amp", "36025.0": "Abokostenanpassung - Kür 25 / Jahr", "36024.0": "T&amp", "36023.0": "T&Emagazin Abon­ne­ment - 1er", "36020.0": "E-Camping - 1 Person - 1 Fahrzeug 19.-21.9.2025", "36017.0": "Eintritts-Ticket 19.-20.9.2025", "36014.0": "Eintritts-Ticket 19.-20.9.2025", "36008.0": "Abschluss-Barbeque 20.9.2025", "36007.0": "T&Emagazin Abon­ne­ment (inkl. Versandpauschale)", "36006.0": "T&Emagazin Abon­ne­ment - 1er", "36003.0": "Eintritts-Ticket 19.-20.9.2025", "36002.0": "T&Emagazin Abon­ne­ment (inkl. Versandpauschale)", "36001.0": "T&Emagazin Abon­ne­ment x 5 Ausgaben (inkl. Versandpauschale)", "36000.0": "T&amp", "35999.0": "T&amp", "35998.0": "T&Emagazin Abon­ne­ment - 1er", "35991.0": "T&amp", "35990.0": "T&Emagazin Abon­ne­ment (inkl. Versandpauschale)", "35984.0": "T&amp", "35981.0": "T&amp", "35979.0": "T&Emagazin Abon­ne­ment (inkl. Versandpauschale)", "35976.0": "E-Camping - 1 Person - 1 Fahrzeug 19.-21.9.2025", "35974.0": "Eintritts-Ticket 19.-20.9.2025", "35972.0": "Tesla-Lightshow-Park-Ticket 19.-20.9.2025", "35967.0": "T&Emagazin Abon­ne­ment x 5 Ausgaben (inkl. Versandpauschale)", "35960.0": "T&amp", "35949.0": "Abschluss-Barbeque 20.9.2025", "35945.0": "T&amp", "35940.0": "Auftakt-Barbeque 19.9.2025", "35937.0": "Tesla-Lightshow-Park-Ticket 19.-20.9.2025", "35936.0": "T&amp", "35935.0": "T&amp", "35927.0": "T&Emagazin Abon­ne­ment (inkl. Versandpauschale)", "35921.0": "Auftakt-Barbeque 19.9.2025", "35919.0": "T&amp", "35916.0": "T&amp", "35915.0": "T&amp", "35914.0": "Abokostenanpassung - Premium 10  / Jahr", "35913.0": "T&amp", "35912.0": "T&amp", "35911.0": "T&Emagazin Abon­ne­ment (inkl. Versandpauschale)", "35910.0": "T&amp", "35909.0": "Abokostenanpassung - Kür 25 / Jahr", "35908.0": "T&amp", "35907.0": "T&amp", "35899.0": "Enthusiasten-Park-Ticket 19.-20.9.2025", "35894.0": "Abschluss-Barbeque 20.9.2025", "35891.0": "T&amp", "35890.0": "Abokostenanpassung - Premium 10  / Jahr", "35888.0": "T&amp", "35883.0": "T&amp", "35881.0": "T&amp", "35880.0": "T&Emagazin Abon­ne­ment - 1er", "35879.0": "Abokostenanpassung - Premium 10  / Jahr", "35878.0": "T&Emagazin Abon­ne­ment x 10 Ausgaben (inkl. Versandpauschale)", "35877.0": "Abokostenanpassung - Basis 5  / Jahr", "35876.0": "Abokostenanpassung - Premium 10  / Jahr", "35874.0": "TFF-Aufkleber - rot (TFF Forum)", "35873.0": "T&amp", "35872.0": "T&Emagazin Abon­ne­ment - 1er", "35868.0": "Enthusiasten-Park-Ticket 19.-20.9.2025", "35867.0": "Abokostenanpassung - Premium 10  / Jahr", "35866.0": "Abokostenanpassung - Premium 10  / Jahr", "35865.0": "Abokostenanpassung - Basis 5  / Jahr", "35864.0": "Abokostenanpassung - Kür 25 / Jahr", "35863.0": "T&amp", "35861.0": "T&Emagazin Abon­ne­ment - 1er", "35860.0": "T&Emagazin Abon­ne­ment - 5er", "35859.0": "Abokostenanpassung - Kür 25 / Jahr", "35858.0": "Abokostenanpassung - Kür 25 / Jahr", "35857.0": "Abokostenanpassung - Premium 10  / Jahr", "35856.0": "Abokostenanpassung - Basis 5  / Jahr", "35855.0": "T&Emagazin Abon­ne­ment - 1er", "35854.0": "Abokostenanpassung - Kür 25 / Jahr", "35853.0": "Abokostenanpassung - Premium 10  / Jahr", "35852.0": "T&amp", "35851.0": "Abokostenanpassung - Basis 5  / Jahr", "35850.0": "Abokostenanpassung - Kür 25 / Jahr", "35849.0": "T&Emagazin Abon­ne­ment - 1er", "35848.0": "T&amp", "35847.0": "Abokostenanpassung - Kür 25 / Jahr", "35846.0": "Abokostenanpassung - Kür 25 / Jahr", "35845.0": "Abokostenanpassung - Premium 10  / Jahr", "35844.0": "Abokostenanpassung - Premium 10  / Jahr", "35843.0": "Abokostenanpassung - Kür 25 / Jahr", "35842.0": "Abokostenanpassung - Premium 10  / Jahr", "35841.0": "Abokostenanpassung - Basis 5  / Jahr", "35840.0": "Abokostenanpassung - Basis 5  / Jahr", "35839.0": "Abokostenanpassung - Basis 5  / Jahr", "35838.0": "Abokostenanpassung - Premium 10  / Jahr", "35837.0": "Abokostenanpassung - Basis 5  / Jahr", "35831.0": "Tesla-Lightshow-Park-Ticket 19.-20.9.2025", "35829.0": "Abokostenanpassung - Basis 5  / Jahr", "35828.0": "T&amp", "35827.0": "T&amp", "35822.0": "Mit E-Campen - 1 Person 19.-21.9.2025", "35821.0": "T&amp", "35813.0": "Abschluss-Barbeque 20.9.2025", "35812.0": "Abokostenanpassung - Premium 10  / Jahr", "35810.0": "T&amp", "35809.0": "Abokostenanpassung - Premium 10  / Jahr", "35807.0": "Abokostenanpassung - Premium 10  / Jahr", "35806.0": "Abokostenanpassung - Premium 10  / Jahr", "35805.0": "Abokostenanpassung - Premium 10  / Jahr", "35804.0": "Abokostenanpassung - Kür 25 / Jahr", "35803.0": "T&amp", "35802.0": "T&Emagazin Abon­ne­ment - 1er", "35801.0": "T&Emagazin Abon­ne­ment - 5er", "35800.0": "Abokostenanpassung - Basis 5  / Jahr", "35799.0": "T&amp", "35797.0": "T&amp", "35796.0": "Abokostenanpassung - Premium 10  / Jahr", "35795.0": "T&amp", "35794.0": "Abokostenanpassung - Basis 5  / Jahr", "35793.0": "T&amp", "35792.0": "Abokostenanpassung - Premium 10  / Jahr", "35791.0": "Abokostenanpassung - Basis 5  / Jahr", "35790.0": "Abokostenanpassung - Premium 10  / Jahr", "35786.0": "Eintritts-Ticket 19.-20.9.2025", "35784.0": "T&amp", "35783.0": "Abokostenanpassung - Premium 10  / Jahr", "35781.0": "T&Emagazin Abon­ne­ment - 5er", "35780.0": "Abokostenanpassung - Premium 10  / Jahr", "35779.0": "Abokostenanpassung - Basis 5  / Jahr", "35778.0": "Abokostenanpassung - Basis 5  / Jahr", "35776.0": "T&Emagazin Abon­ne­ment x 5 Ausgaben (inkl. Versandpauschale)", "35775.0": "Abokostenanpassung - Basis 5  / Jahr", "35774.0": "Abokostenanpassung - Premium 10  / Jahr", "35773.0": "T&amp", "35772.0": "Abokostenanpassung - Premium 10  / Jahr", "35771.0": "Abokostenanpassung - Kür 25 / Jahr", "35770.0": "Abokostenanpassung - Premium 10  / Jahr", "35769.0": "Abokostenanpassung - Basis 5  / Jahr", "35768.0": "T&Emagazin Abon­ne­ment - 1er", "35767.0": "Abokostenanpassung - Kür 25 / Jahr", "35766.0": "Abokostenanpassung - Basis 5  / Jahr", "35765.0": "Abokostenanpassung - Premium 10  / Jahr", "35764.0": "T&amp", "35763.0": "T&amp", "35762.0": "Abokostenanpassung - Premium 10  / Jahr", "35761.0": "Abokostenanpassung - Premium 10  / Jahr", "35760.0": "Abokostenanpassung - Premium 10  / Jahr", "35758.0": "T&Emagazin Abon­ne­ment (inkl. Versandpauschale)", "35757.0": "Abokostenanpassung - Kür 25 / Jahr", "35756.0": "Abokostenanpassung - Basis 5  / Jahr", "35755.0": "Abokostenanpassung - Premium 10  / Jahr", "35754.0": "Abokostenanpassung - Basis 5  / Jahr", "35753.0": "Abokostenanpassung - Premium 10  / Jahr", "35752.0": "Abokostenanpassung - Premium 10  / Jahr", "35751.0": "Abokostenanpassung - Kür 25 / Jahr", "35750.0": "Abokostenanpassung - Basis 5  / Jahr", "35749.0": "Abokostenanpassung - Kür 25 / Jahr", "35748.0": "Abokostenanpassung - Premium 10  / Jahr", "35747.0": "Abokostenanpassung - Basis 5  / Jahr", "35746.0": "Abokostenanpassung - Basis 5  / Jahr", "35745.0": "Abokostenanpassung - Premium 10  / Jahr", "35744.0": "T&Emagazin Abon­ne­ment - 1er", "35742.0": "T&amp", "35741.0": "T&amp", "35740.0": "T&Emagazin Abon­ne­ment x 5 Ausgaben (inkl. Versandpauschale)", "35739.0": "T&amp", "35738.0": "T&amp", "35734.0": "Abschluss-Barbeque 20.9.2025", "35726.0": "Abschluss-Barbeque 20.9.2025", "35723.0": "Eintritts-Ticket 19.-20.9.2025", "35718.0": "Enthusiasten-Park-Ticket 19.-20.9.2025", "35716.0": "T&amp", "35715.0": "T&Emagazin Abon­ne­ment - 5er", "35713.0": "T&amp", "35712.0": "T&amp", "35711.0": "T&Emagazin Abon­ne­ment x 5 Ausgaben (inkl. Versandpauschale)", "35705.0": "T&amp", "35704.0": "Abokostenanpassung - Basis 5  / Jahr", "35699.0": "Enthusiasten-Park-Ticket 19.-20.9.2025", "35697.0": "T&amp", "35696.0": "T&amp", "35695.0": "T&Emagazin Abon­ne­ment (inkl. Versandpauschale)", "35691.0": "Mit E-Campen - 1 Person 19.-21.9.2025", "35685.0": "Mit E-Campen - 1 Person 19.-21.9.2025", "35681.0": "Tesla-Lightshow-Park-Ticket 19.-20.9.2025", "35677.0": "Tesla-Lightshow-Park-Ticket 19.-20.9.2025", "35670.0": "Abschluss-Barbeque (Kids) 20.9.2025", "35665.0": "Abschluss-Barbeque 20.9.2025", "35660.0": "Abschluss-Barbeque 20.9.2025", "35658.0": "Eintritts-Ticket 19.-20.9.2025", "35651.0": "Abschluss-Barbeque 20.9.2025", "35647.0": "Abschluss-Barbeque 20.9.2025", "35644.0": "Eintritts-Ticket 19.-20.9.2025", "35642.0": "T&amp", "35636.0": "Abschluss-Barbeque 20.9.2025", "35632.0": "Tesla-Lightshow-Park-Ticket 19.-20.9.2025", "35623.0": "Abschluss-Barbeque 20.9.2025", "35620.0": "E-Camping - 1 Person - 1 Fahrzeug 19.-21.9.2025", "35619.0": "T&amp", "35597.0": "Abschluss-Barbeque (Kids) 20.9.2025", "35584.0": "Abschluss-Barbeque (Kids) 20.9.2025", "35582.0": "T&amp", "35580.0": "T&Emagazin Abon­ne­ment (inkl. Versandpauschale)", "35570.0": "Eintritts-Ticket 19.-20.9.2025", "35566.0": "Kinder-Ticket 19.-20.9.2025", "35545.0": "T&amp", "35544.0": "T&amp", "35540.0": "T&amp", "35539.0": "T&amp", "35538.0": "T&amp", "35537.0": "Tesla-Lightshow-Park-Ticket 19.-20.9.2025", "35536.0": "T&amp", "35532.0": "Enthusiasten-Park-Ticket 19.-20.9.2025", "35531.0": "T&Emagazin Abon­ne­ment x 10 Ausgaben (inkl. Versandpauschale)", "35530.0": "TFF-Broschüre \"Alles rund um Ihren Tesla\" 1x", "35515.0": "T&Emagazin Abon­ne­ment - 1er", "35482.0": "T&amp", "35481.0": "T&Emagazin Abon­ne­ment x 5 Ausgaben (inkl. Versandpauschale)", "35480.0": "T&Emagazin Abon­ne­ment - 5er", "35479.0": "T&amp", "35478.0": "T&Emagazin Abon­ne­ment - 5er", "35477.0": "T&amp", "35476.0": "T&Emagazin Abon­ne­ment - 1er", "35475.0": "T&Emagazin Abon­ne­ment - 1er", "35474.0": "T&Emagazin Abon­ne­ment - 1er", "35473.0": "T&amp", "35472.0": "T&amp", "35471.0": "T&amp", "35470.0": "Abokostenanpassung - Kür 25 / Jahr", "35469.0": "T&amp", "35468.0": "T&amp", "35467.0": "T&Emagazin Abon­ne­ment - 1er", "35466.0": "T&amp", "35463.0": "T&Emagazin Abon­ne­ment x 10 Ausgaben (inkl. Versandpauschale)", "35462.0": "T&amp", "35460.0": "T&amp", "35459.0": "T&amp", "35457.0": "T&Emagazin Abon­ne­ment - 1er", "35456.0": "T&amp", "35455.0": "T&Emagazin Abon­ne­ment - 1er", "35454.0": "T&amp", "35453.0": "T&Emagazin Abon­ne­ment - 5er", "35452.0": "T&Emagazin Abon­ne­ment - 5er", "35451.0": "T&Emagazin Abon­ne­ment - 1er", "35450.0": "T&Emagazin Abon­ne­ment - 1er", "35449.0": "T&Emagazin Abon­ne­ment - 1er", "35448.0": "T&Emagazin Abon­ne­ment - 1er", "35447.0": "T&amp", "35445.0": "T&amp", "35444.0": "T&amp", "35443.0": "T&Emagazin Abon­ne­ment - 5er", "35442.0": "T&Emagazin Abon­ne­ment - 5er", "35440.0": "T&amp", "35438.0": "T&amp", "35437.0": "T&amp", "35436.0": "T&Emagazin Abon­ne­ment - 1er", "35435.0": "T&Emagazin Abon­ne­ment - 5er", "35433.0": "T&amp", "35432.0": "T&amp", "35431.0": "T&Emagazin Abon­ne­ment - 1er", "35430.0": "T&Emagazin Abon­ne­ment - 1er", "35429.0": "T&Emagazin Abon­ne­ment - 1er", "35428.0": "T&Emagazin Abon­ne­ment - 1er", "35427.0": "T&Emagazin Abon­ne­ment - 1er", "35426.0": "T&amp", "35424.0": "T&Emagazin Abon­ne­ment (inkl. Versandpauschale)", "35422.0": "T&amp", "35417.0": "Die T&amp", "35416.0": "T&amp", "35415.0": "T&amp", "35414.0": "T&amp", "35413.0": "T&Emagazin Abon­ne­ment - 1er", "35412.0": "T&Emagazin Abon­ne­ment - 1er", "35411.0": "T&Emagazin Abon­ne­ment - 5er", "35410.0": "T&Emagazin Abon­ne­ment x 10 Ausgaben (inkl. Versandpauschale)", "35409.0": "T&Emagazin Abon­ne­ment - 1er", "35408.0": "T&Emagazin Abon­ne­ment - 1er", "35407.0": "T&Emagazin Abon­ne­ment x 5 Ausgaben (inkl. Versandpauschale)", "35406.0": "T&Emagazin Abon­ne­ment (inkl. Versandpauschale)", "35405.0": "T&amp", "35404.0": "T&Emagazin Abon­ne­ment (inkl. Versandpauschale)", "35403.0": "T&Emagazin Abon­ne­ment - 1er", "35402.0": "T&Emagazin Abon­ne­ment - 1er", "35401.0": "T&Emagazin Abon­ne­ment x 5 Ausgaben (inkl. Versandpauschale)", "35400.0": "T&amp", "35399.0": "T&Emagazin Abon­ne­ment (inkl. Versandpauschale)", "35398.0": "T&Emagazin Abon­ne­ment (inkl. Versandpauschale)", "35397.0": "T&Emagazin Abon­ne­ment - 1er", "35396.0": "T&amp", "35395.0": "T&Emagazin Abon­ne­ment (inkl. Versandpauschale)", "35392.0": "T&amp", "35391.0": "T&amp", "35390.0": "T&Emagazin Abon­ne­ment - 1er", "35389.0": "Abokostenanpassung - Basis 5  / Jahr", "35388.0": "T&amp", "35387.0": "T&Emagazin Abon­ne­ment - 1er", "35386.0": "T&Emagazin Abon­ne­ment x 5 Ausgaben (inkl. Versandpauschale)"};
  let detectedTicket = "Ticket-ID";
  let detectedItem = "Item Name";

  try {
    const saved = localStorage.getItem("ticket_mapping_v2");
    if (saved) {
      const parsed = JSON.parse(saved);
      if (parsed && parsed.mapping) {
        TICKET_TO_ITEM = parsed.mapping;
        detectedTicket = parsed.ticketCol || detectedTicket;
        detectedItem = parsed.itemCol || detectedItem;
        document.getElementById('sourceLabel').textContent = "Lokal gespeichert";
        document.getElementById('updatedLabel').textContent = new Date(parsed.updatedAt).toLocaleString();
        document.getElementById('count').textContent = Object.keys(TICKET_TO_ITEM).length;
        document.getElementById('ticketColPill').textContent = detectedTicket;
        document.getElementById('itemColPill').textContent = detectedItem;
      }
    } else {
      document.getElementById('count').textContent = Object.keys(TICKET_TO_ITEM).length;
    }
  } catch(e) {}

  function extractTicketId(raw) {
    if (!raw) return "";
    let s = String(raw).trim();
    try {
      if (!/^https?:\/\//i.test(s) && s.includes(".")) s = "https://" + s;
      const u = new URL(s);
      const params = new URLSearchParams(u.search);
      const keys = ["ticket_id","ticket","id","tid"];
      for (const k of keys) {
        const v = params.get(k) || params.get(k.toUpperCase());
        if (v) return v.trim();
      }
      // also scan all params case-insensitively
      for (const [p, v] of params.entries()) {
        if (["ticket_id","ticket","id","tid"].includes(p.toLowerCase()) && v) return v.trim();
      }
    } catch(e) {}
    const qIndex = s.indexOf("?");
    if (qIndex !== -1) {
      const qs = s.slice(qIndex+1);
      const parts = qs.split("&");
      for (const part of parts) {
        const [k,v] = part.split("=");
        if (!k) continue;
        const key = decodeURIComponent(k).toLowerCase();
        const val = v ? decodeURIComponent(v) : "";
        if (["ticket_id","ticket","id","tid"].includes(key) && val) return val.trim();
      }
    }
    return s;
  }

  function normalizeToKey(input) {
    const id = extractTicketId(input);
    if (!id) return "";
    if (TICKET_TO_ITEM[id] !== undefined) return id;
    const n = parseInt(id, 10);
    if (!Number.isNaN(n)) {
      const alt = String(n);
      if (TICKET_TO_ITEM[alt] !== undefined) return alt;
    }
    if (/^\d+$/.test(id)) {
      for (const k in TICKET_TO_ITEM) {
        if (/^\d+$/.test(k) && parseInt(k,10) === parseInt(id,10)) return k;
      }
    }
    return id;
  }

  function lookupValue(input) {
    const key = normalizeToKey(input);
    const val = TICKET_TO_ITEM[key];
    if (val !== undefined) return { ok:true, id:key, item:val };
    return { ok:false, id:key, message:"Keine Zuordnung gefunden." };
  }

  const input = document.getElementById('ticketInput');
  const btn = document.getElementById('lookupBtn');
  const lookupResult = document.getElementById('lookupResult');
  function renderLookup(res) {
    if (res.ok) {
      lookupResult.innerHTML = `<div><strong>Ticket-ID:</strong> ${res.id}</div><div><strong>Item:</strong> <span class="success">${res.item}</span></div>`;
    } else {
      lookupResult.innerHTML = `<div><strong>Ticket-ID (extrahiert):</strong> ${res.id || "–"}</div><div class="danger">${res.message}</div>`;
    }
  }
  btn.addEventListener('click', () => renderLookup(lookupValue(input.value)));
  input.addEventListener('keydown', (e) => { if (e.key === 'Enter') renderLookup(lookupValue(input.value)); });

  const video = document.getElementById('video');
  const canvas = document.getElementById('canvas');
  const ctx = canvas.getContext('2d');
  const scanStatus = document.getElementById('scanStatus');
  const scanResult = document.getElementById('scanResult');

  async function startCamera() {
    try {
      const stream = await navigator.mediaDevices.getUserMedia({ video: { facingMode: "environment" } });
      video.srcObject = stream;
      await video.play();
      scanStatus.textContent = "Kamera aktiv.";
      tick();
    } catch (e) {
      scanStatus.textContent = "Kamera nicht verfügbar oder gesperrt.";
    }
  }
  function tick() {
    if (video.readyState === video.HAVE_ENOUGH_DATA) {
      canvas.width = video.videoWidth;
      canvas.height = video.videoHeight;
      ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
      const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
      try {
        const code = jsQR(imageData.data, imageData.width, imageData.height);
        if (code && code.data) {
          const res = lookupValue(code.data);
          if (res.ok) {
            scanResult.innerHTML = `<div><strong>Ticket-ID:</strong> ${res.id}</div><div><strong>Item:</strong> <span class="success">${res.item}</span></div>`;
          } else {
            scanResult.innerHTML = `<div><strong>Gelesen (extrahiert):</strong> ${res.id}</div><div class="danger">${res.message}</div>`;
          }
        }
      } catch (e) {}
    }
    requestAnimationFrame(tick);
  }
  if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) startCamera();

  const csvInput = document.getElementById('csvFile');
  const loadBtn = document.getElementById('loadCsvBtn');
  const clearBtn = document.getElementById('clearLocalBtn');
  const dropzone = document.getElementById('dropzone');
  const colPicker = document.getElementById('colPicker');
  const ticketSelect = document.getElementById('ticketSelect');
  const itemSelect = document.getElementById('itemSelect');
  const applyColsBtn = document.getElementById('applyColsBtn');
  let lastCSV = null;

  loadBtn.addEventListener('click', () => csvInput.click());
  csvInput.addEventListener('change', (e) => handleFiles(e.target.files));

  function handleFiles(files) {
    if (!files || !files[0]) return;
    const file = files[0];
    Papa.parse(file, {
      header: true,
      dynamicTyping: false,
      skipEmptyLines: true,
      complete: (res) => onCSVParsed(res, file.name),
      error: (err) => alert("CSV Fehler: " + err)
    });
  }

  function onCSVParsed(res, filename) {
    if (!res || !res.meta || !res.meta.fields) {
      alert("Konnte Spaltenüberschriften nicht erkennen.");
      return;
    }
    const headers = res.meta.fields;
    const rows = res.data || [];
    lastCSV = { headers, rows };
    ticketSelect.innerHTML = "";
    itemSelect.innerHTML = "";
    headers.forEach(h => {
      const o1 = document.createElement('option'); o1.value = h; o1.textContent = h; ticketSelect.appendChild(o1);
      const o2 = document.createElement('option'); o2.value = h; o2.textContent = h; itemSelect.appendChild(o2);
    });
    ticketSelect.value = detectTicket(headers);
    itemSelect.value = detectItem(headers);
    colPicker.style.display = "block";
    document.getElementById('sourceLabel').textContent = "Hochgeladene CSV (" + filename + ")";
  }

  function detectTicket(headers) {
    const score = (c) => {
      const lc = c.toLowerCase();
      let s = 0;
      if (lc.includes("ticket")) s += 2;
      if (/\bid\b/.test(lc)) s += 2;
      if (lc.includes("qr")) s += 1;
      if (lc.includes("code")) s += 1;
      if (["id","ticket","ticket id","ticket_id","ticket-id"].includes(lc)) s += 3;
      return s;
    };
    return headers.slice().sort((a,b)=>score(b)-score(a))[0];
  }
  function detectItem(headers) {
    const score = (c) => {
      const lc = c.toLowerCase();
      let s = 0;
      ["item","artikel","name","produkt","product","buchung","tarif","paket","ticketname","event","kategorie"].forEach(kw=>{ if (lc.includes(kw)) s+=1; });
      if (/\bid\b/.test(lc)) s -= 1;
      return s;
    };
    return headers.slice().sort((a,b)=>score(b)-score(a))[0];
  }

  function buildMapping(rows, ticketCol, itemCol) {
    const map = {};
    rows.forEach(r => {
      const k = String(r[ticketCol] ?? "").trim();
      const v = String(r[itemCol] ?? "").trim();
      if (k) map[k] = v;
    });
    return map;
  }

  applyColsBtn.addEventListener('click', () => {
    if (!lastCSV) return;
    const tCol = ticketSelect.value;
    const iCol = itemSelect.value;
    const newMap = buildMapping(lastCSV.rows, tCol, iCol);
    if (!Object.keys(newMap).length) {
      alert("Die gewählten Spalten ergeben keine Zuordnung.");
      return;
    }
    TICKET_TO_ITEM = newMap;
    detectedTicket = tCol;
    detectedItem = iCol;
    document.getElementById('ticketColPill').textContent = detectedTicket;
    document.getElementById('itemColPill').textContent = detectedItem;
    document.getElementById('count').textContent = Object.keys(TICKET_TO_ITEM).length;
    document.getElementById('updatedLabel').textContent = new Date().toLocaleString();
    try {
      localStorage.setItem("ticket_mapping_v2", JSON.stringify({
        mapping: TICKET_TO_ITEM,
        ticketCol: detectedTicket,
        itemCol: detectedItem,
        updatedAt: Date.now()
      }));
    } catch(e) {}
    alert("Datensatz übernommen. Scanner & Suche nutzen nun die neue CSV.");
  });

  ['dragenter','dragover','dragleave','drop'].forEach(evt => dropzone.addEventListener(evt, e=>{ e.preventDefault(); e.stopPropagation(); }));
  ['dragenter','dragover'].forEach(evt => dropzone.addEventListener(evt, ()=> dropzone.style.borderColor = '#3b82f6'));
  ['dragleave','drop'].forEach(evt => dropzone.addEventListener(evt, ()=> dropzone.style.borderColor = 'rgba(255,255,255,.2)'));
  dropzone.addEventListener('drop', (e)=>{
    const dt = e.dataTransfer;
    if (dt && dt.files && dt.files.length) handleFiles(dt.files);
  });

  document.getElementById('clearLocalBtn').addEventListener('click', ()=>{
    localStorage.removeItem("ticket_mapping_v2");
    alert("Lokales Mapping gelöscht. Bitte CSV neu laden.");
    location.reload();
  });
  </script>
</body>
</html>
